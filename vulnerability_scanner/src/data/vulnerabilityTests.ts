import { VulnerabilityTest } from '../types/vulnerability';

export const vulnerabilityTests: VulnerabilityTest[] = [
  // Authentication Vulnerabilities
  {
    id: 'broken-auth-weak-token',
    name: 'Broken Authentication - Weak Token',
    description: 'Deteksi token autentikasi yang lemah atau mudah ditebak',
    category: 'auth',
    severity: 'critical',
    enabled: true,
    payloads: ['admin', '123456', 'password', 'token', 'test']
  },
  {
    id: 'broken-auth-basic-no-tls',
    name: 'Basic Auth tanpa TLS',
    description: 'Deteksi penggunaan Basic Authentication tanpa enkripsi TLS',
    category: 'auth',
    severity: 'high',
    enabled: true
  },
  {
    id: 'token-manipulation',
    name: 'Token Manipulation',
    description: 'Pengujian manipulasi token untuk bypass autentikasi',
    category: 'auth',
    severity: 'critical',
    enabled: true,
    payloads: ['null', 'undefined', '""', 'admin', 'root']
  },

  // Injection Vulnerabilities
  {
    id: 'sql-injection',
    name: 'SQL Injection',
    description: 'Deteksi kerentanan SQL Injection pada parameter',
    category: 'injection',
    severity: 'critical',
    enabled: true,
    payloads: [
      "' OR '1'='1",
      "'; DROP TABLE users; --",
      "' UNION SELECT * FROM users --",
      "1' OR 1=1 --",
      "admin'--",
      "' OR 'x'='x",
      "1; SELECT * FROM information_schema.tables --"
    ]
  },
  {
    id: 'rce-detection',
    name: 'Remote Code Execution',
    description: 'Deteksi payload RCE yang mencurigakan',
    category: 'injection',
    severity: 'critical',
    enabled: true,
    payloads: [
      'system("whoami")',
      'exec("ls -la")',
      '$(whoami)',
      '`id`',
      '; cat /etc/passwd',
      '| nc -e /bin/sh',
      'eval($_GET["cmd"])'
    ]
  },
  {
    id: 'path-traversal',
    name: 'Path Traversal',
    description: 'Deteksi serangan path traversal',
    category: 'injection',
    severity: 'high',
    enabled: true,
    payloads: [
      '../../etc/passwd',
      '../../../windows/system32/drivers/etc/hosts',
      '....//....//....//etc/passwd',
      '%2e%2e%2f%2e%2e%2f%2e%2e%2fetc%2fpasswd',
      '..\\..\\..\\windows\\system32\\drivers\\etc\\hosts'
    ]
  },

  // Data Exposure
  {
    id: 'sensitive-data-exposure',
    name: 'Sensitive Data Exposure',
    description: 'Deteksi eksposur data sensitif seperti password plaintext',
    category: 'exposure',
    severity: 'high',
    enabled: true
  },
  {
    id: 'idor-detection',
    name: 'Insecure Direct Object Reference',
    description: 'Deteksi IDOR pada endpoint yang mengakses objek tanpa otorisasi',
    category: 'logic',
    severity: 'high',
    enabled: true,
    payloads: ['1', '2', '999', 'admin', 'root', '../1', '0']
  },

  // Server-Side Request Forgery
  {
    id: 'ssrf-detection',
    name: 'Server-Side Request Forgery',
    description: 'Deteksi SSRF dengan URL internal atau metadata AWS',
    category: 'injection',
    severity: 'high',
    enabled: true,
    payloads: [
      'http://127.0.0.1',
      'http://localhost',
      'http://169.254.169.254/latest/meta-data/',
      'http://metadata.google.internal/',
      'file:///etc/passwd',
      'gopher://127.0.0.1:25/'
    ]
  },

  // Deserialization
  {
    id: 'insecure-deserialization',
    name: 'Insecure Deserialization',
    description: 'Deteksi payload deserialisasi yang mencurigakan',
    category: 'injection',
    severity: 'high',
    enabled: false,
    payloads: [
      'O:8:"stdClass":0:{}',
      'rO0ABXNyABFqYXZhLnV0aWwuSGFzaE1hcA==',
      'YToxOntzOjM6ImNtZCI7czo2OiJ3aG9hbWkiO30='
    ]
  },

  // Misconfiguration
  {
    id: 'server-info-leak',
    name: 'Server Information Disclosure',
    description: 'Deteksi kebocoran informasi server',
    category: 'config',
    severity: 'medium',
    enabled: true
  },
  {
    id: 'debug-mode-detection',
    name: 'Debug Mode Detection',
    description: 'Deteksi mode debug yang aktif',
    category: 'config',
    severity: 'medium',
    enabled: true
  },
  {
    id: 'directory-listing',
    name: 'Directory Listing',
    description: 'Deteksi directory listing yang terbuka',
    category: 'config',
    severity: 'low',
    enabled: true
  }
];